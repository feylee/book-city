"use strict";define(["jquery","template","text!../../tql/reader.html","base64"],function(c,i,s){var o=window.localStorage,t=o.getItem("fontSize")||16,l=o.getItem("chapter_id")||1;c(".book-cont").css("font-size",t);var a=null;function n(){o.setItem("chapter_id",l),c.ajax({url:"/book/reader-list?article="+l,dataType:"json",success:function(o){console.log(o);var t,e,n=o.jsonp;t=n,(e=document.createElement("script")).src=t,window.duokan_fiction_chapter=function(o){c(".book-cont").empty();var t=c.base64().decode(o);i(s,JSON.parse(t),".book-cont");var n=a.length;c(".f_top_num").html(l+"/"+n),document.head.removeChild(e)},document.head.appendChild(e)}})}c.ajax({url:"/book/menu-list",dataType:"json",async:!1,success:function(o){a=o.item.toc}}),n(),c(".menu-btn").on("click",function(){i(c(".menulist").html(),{list:a},".book-list .listmain ul"),c(".book-list").addClass("show")}),c(".listmain").on("click","li",function(){l=c(this).data("id"),n(),console.log(l),c(".book-list").removeClass("show")}),c(".prev-btn").on("click",function(){if(--l<=0)return!1;n()}),c(".next-btn").on("click",function(){if(++l>a.length)return!1;n()}),c(".reader__back").on("click",function(){c(".listmain ul").empty(),c(".book-list").removeClass("show")}),c(".book-cont").on("click",function(){c(".book-mask").toggle()}),c("section").on("click",function(){c(".book-mask").toggle()}),c(".font").on("click",function(){c(".font-dialog").toggle()}),c("ol li").on("click",function(){c(".book-cont").css({background:c(this).css("background"),color:"#333"}),c(this).addClass("active").siblings().removeClass("active")}),c("button").on("click",function(){"大"==c(this).text()?(t+=2,fontnum1=parseInt(t),c(".book-cont").css("font-size",t),console.log(fontnum1),o.setItem("fontSize",t)):"小"==c(this).text()&&16<t&&(t-=2,console.log(t),c(".book-cont").css("font-size",t),o.setItem("fontSize",t))}),c(".change").on("click",function(){c(".book-cont").toggleClass("light"),"book-cont light"==c(".book-cont").attr("class")?c(this).text("白天"):c(this).text("黑夜")})});